(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[293],{5815:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ads/create/[...createid]",function(){return n(4162)}])},6367:function(e,t,n){"use strict";n.d(t,{bl:function(){return l.b},wT:function(){return s.wT},P$:function(){return a},o$:function(){return r}});var a={};n.r(a),n.d(a,{Vl:function(){return d}});var r={};n.r(r),n.d(r,{_l:function(){return o}});var i=n(5387),l=n(8791),s=n(4511);let d="\n  mutation CreateAd($input: CreateAdInput!, $condition: ModelAdConditionInput) {\n    createAd(input: $input, condition: $condition) {\n      id\n      cat\n      condition\n      currency\n      data\n      date\n      description\n      images\n      parrent\n      phone\n      physical\n      price\n      query\n      slug\n      source\n      title\n      type\n      uid\n      sortID\n      createdAt\n      updatedAt\n      _version\n      _deleted\n      _lastChangedAt\n    }\n  }\n",o="\n  query GetAd($id: ID!) {\n    getAd(id: $id) {\n      id\n      cat\n      condition\n      currency\n      data\n      date\n      description\n      images\n      parrent\n      phone\n      physical\n      price\n      query\n      slug\n      source\n      title\n      type\n      uid\n      sortID\n      createdAt\n      updatedAt\n      _version\n      _deleted\n      _lastChangedAt\n    }\n  }\n";i.d.configure({aws_project_region:"eu-west-1",aws_cognito_identity_pool_id:"eu-west-1:2f394adb-6fe3-42e6-9cfb-e552b456a0a8",aws_cognito_region:"eu-west-1",aws_user_files_s3_bucket:"eziktok-s3",aws_user_files_s3_bucket_region:"us-east-1"}),l.b.configure({aws_appsync_graphqlEndpoint:"https://f64iubro75ad5lc77hqjepavdu.appsync-api.eu-west-1.amazonaws.com/graphql",aws_appsync_region:"eu-west-1",aws_appsync_authenticationType:"API_KEY",aws_appsync_apiKey:"da2-cqo7gn4b4fcbfcl2miw67inaxy"})},993:function(e,t,n){"use strict";var a=n(5893),r=n(7294);let i={AuthError:"Потребителското име не може да бъде празно",InvalidParameterException:"Неуспешно доставяне на код - Моля попълнете всички полета",CodeDeliveryFailureException:"Неуспешно доставяне на код - моля, проверете имейла си и опитайте отново",CodeMismatchException:"Несъответствие на кода - Моля, проверете кода и опитайте отново",InvalidPasswordException:"Невалидна парола - Моля, проверете паролата си и опитайте отново",NotAuthorizedException:"Не е упълномощен - не сте упълномощени за достъп до този ресурс",PasswordResetRequiredException:"Изисква се нулиране на паролата - Моля, нулирайте паролата си и опитайте отново",TooManyFailedAttemptsException:"Твърде много неуспешни опити - акаунтът ви е заключен от съображения за сигурност. Моля, опитайте отново по-късно",TooManyRequestsException:"Твърде много заявки - моля, опитайте отново по-късно",UnauthorizedException:"Неупълномощен - не сте упълномощени за достъп до този ресурс",UsernameExistsException:"Потребителското име съществува - Моля, изберете друго потребителско име и опитайте отново",UserNotConfirmedException:"Потребителят не е потвърден - Моля, потвърдете акаунта си и опитайте отново",UserNotFoundException:"Потребителят не е намерен - Моля, проверете потребителското име и опитайте отново"},l=e=>{let{err:t}=e,[n,l]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{l(!1)},[t]),n?(0,a.jsx)(a.Fragment,{}):(0,a.jsxs)("div",{className:"mx-auto-cols-auto stickyerror flex p-3 bg-pink-700 rounded-b-lg justify-center items-center",children:[(0,a.jsx)("div",{className:"pr-3 absolute left-3 cursor-pointer",onClick:()=>l(!0),children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 shrink-0 cursor-pointer stroke-current",fill:"none",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,a.jsx)("div",{children:i[t.name]?i[t.name]:t.message})]})};t.Z=l},8969:function(e,t,n){"use strict";var a=n(5893),r=n(7294),i=n(1852),l=n(8240);let s=e=>{let{name:t,required:n,options:s,placeholder:d,submitted:o,value:c}=e,[u,p]=(0,r.useState)([]),m=e=>{let{checked:t,value:n}=e.target;t?p([...u,n]):p(u.filter(e=>e!==n))};(0,r.useEffect)(()=>{p(c||[])},[c]);let h=o&&n&&0===u.length,[x,f]=(0,r.useState)("w-full gap-0 grid"),g=[{minWidth:300},{maxWidth:400},{minWidth:500},{maxWidth:600},{minWidth:700},{maxWidth:800},{maxWidth:900},{minWidth:1e3}].map(e=>(0,i.useMediaQuery)(e)).filter(Boolean).length;return(0,r.useEffect)(()=>{f("w-full gap-0 grid cols-".concat(g))},[]),(0,a.jsxs)("div",{className:"md:flex mb-2",children:[(0,a.jsx)(l.Z,{required:n,placeholder:d||"",submitted:o}),(0,a.jsx)("div",{className:x,children:s.map(e=>(0,a.jsxs)("label",{className:"label cursor-pointer flex justify-start",children:[(0,a.jsx)("input",{name:t,type:"checkbox",...n?{required:!0}:{},checked:u.includes(e),className:"checkbox ".concat(h?"checkbox-secondary border-2":"checkbox-accent  border-2"),value:e,placeholder:d,onChange:e=>m(e)}),(0,a.jsx)("div",{className:"w-full truncate text-sm",children:e})]},e))})]})};t.Z=s},325:function(e,t,n){"use strict";var a=n(5893),r=n(7294),i=n(8240);let l=(e,t)=>{(0,r.useEffect)(()=>{if(e){e.style.height="0px";let t=e.scrollHeight;e.style.height="".concat(t,"px")}},[e,t])},s=e=>{let{name:t,placeholder:n,type:s,value:d,required:o,after:c,submitted:u}=e,[p,m]=(0,r.useState)(d||""),h=!p&&o&&u,x=(0,r.useRef)(null);return l(x.current,p),(0,a.jsxs)("div",{className:"hidden"===s?"hidden":"md:flex md:items-center mb-2",children:[(0,a.jsx)(i.Z,{required:o,placeholder:n||"",submitted:u}),(0,a.jsxs)("div",{className:"w-full flex",children:["textarea"===s?(0,a.jsx)("textarea",{...o?{required:!0}:{},ref:x,className:"".concat(h?"textarea-secondary border-2":"textarea-accent"," textarea w-full  overflow-hidden border-2  h-14 bgaccent "),value:p,rows:3,name:t,placeholder:n,onChange:e=>m(e.target.value)}):(0,a.jsx)("input",{...o?{required:!0}:{},type:s||"text",placeholder:n,className:"".concat(h?"inputerror":"inputx"," w-full flex-1 border-2"),name:t,value:p,alt:c,onChange:e=>m(e.target.value)}),c&&(0,a.jsx)("div",{className:"flex-1 flex justify-center items-center pl-2 text-xs",children:c})]})]})};t.Z=s},8240:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(5893);function r(e){let{placeholder:t,required:n}=e;return(0,a.jsx)("div",{className:"w-full md:w-1/4 pr-2 align-top flex md:justify-end",children:(0,a.jsxs)("div",{className:"self-start text-sm",children:[t," ",void 0!==n&&(0,a.jsx)("span",{className:"text-red-600",children:"*"})]})})}n(7294)},3122:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(7294);function r(e,t){let[n,r]=(0,a.useState)(()=>{try{let n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(a){return console.log(a),t}}),i=t=>{try{let a=t instanceof Function?t(n):t;r(a),window.localStorage.setItem(e,JSON.stringify(a))}catch(i){console.log(i)}};return[n,i]}},4162:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return E},default:function(){return C}});var a=n(5893),r=n(4730),i=n(3122),l=n(8062),s=n(8791),d=n(4511),o=n(16),c=n(6367);new o.CognitoJwtVerifier;let u=async e=>{console.log(e);let t=await s.b.graphql((0,d.wT)(c.o$._l,{id:e}));if(t.data.getAd)return"";throw{message:"моля оторизирайте се"}};var p=n(1163),m=n(7294),h=n(8969),x=n(1852),f=n(8240);let g=e=>{let{name:t,required:n,options:r,placeholder:i,submitted:l}=e,[s,d]=(0,m.useState)(""),[o,c]=(0,m.useState)("w-full gap-0 grid"),u=[{minWidth:300},{maxWidth:400},{minWidth:500},{maxWidth:600},{minWidth:700},{maxWidth:800},{maxWidth:900},{minWidth:1e3}].map(e=>(0,x.useMediaQuery)(e)).filter(Boolean).length;return(0,m.useEffect)(()=>{c("w-full gap-0 grid cols-".concat(u))},[]),(0,a.jsxs)("div",{className:"md:flex md:items-center mb-2",children:[(0,a.jsx)(f.Z,{required:n,placeholder:i||"",submitted:l}),(0,a.jsx)("div",{className:o,children:null==r?void 0:r.map(e=>(0,a.jsxs)("div",{className:"flex items-center mb-2 od:bg-white even:bg-accent-black",children:[(0,a.jsx)("input",{type:"radio",name:t,...n||!1===n?{required:!0}:{},placeholder:i,checked:s===e,className:l&&n?"radio  radio-secondary  border-2":"radio  radio-accent  border-2",onChange:e=>d(e.target.value),value:e},e),(0,a.jsx)("div",{className:"label-text ml-1 font-bold flex-col",children:e})]},e))})]})},v=e=>{let{name:t,required:n,options:r,placeholder:i,submitted:l}=e,[s,d]=(0,m.useState)("");return(0,a.jsxs)("div",{className:"md:flex mb-2",children:[(0,a.jsx)(f.Z,{required:n,placeholder:i||"",submitted:l}),(0,a.jsx)("div",{className:"w-full",children:(0,a.jsxs)("select",{className:"select select-bordered ".concat(!s&&l&&n?"inputerror border-2":"select-success","  bg-gray-800 dark:bg-white border-2 w-fit"),name:t,value:s,onChange:e=>d(e.target.value),children:[(0,a.jsx)("option",{defaultValue:""}),null==r?void 0:r.map(e=>(0,a.jsx)("option",{defaultValue:e,children:e},e))]})})]})};var b=n(325),y=n(5152),w=n.n(y),j=n(6486);let _=w()(()=>Promise.all([n.e(708),n.e(131),n.e(36)]).then(n.bind(n,36)),{loadableGenerated:{webpack:()=>[36]},suspense:!0}),N=async e=>{e.preventDefault();let t=Object.values(e.target).filter(e=>"string"==typeof e.tagName&&("input"===e.tagName.toLowerCase()||"textarea"===e.tagName.toLowerCase()||"select"===e.tagName.toLowerCase())).map(e=>({type:e.type||e.tagName,name:e.name,checked:e.checked,value:e.value,placeholder:e.placeholder,alt:e.alt})),n=(0,j.groupBy)(t.filter(e=>e.checked),e=>e.name||e.placeholder),a=(0,j.keyBy)(t.filter(e=>"text"===e.type||"password"===e.type||"hidden"===e.type||"number"===e.type||"textarea"===e.type||"select"===e.type),e=>e.name);return{...n,...a}},q=e=>{let{inputschema:t,submitted:n}=e;switch(t.type){case"upload":return(0,a.jsx)(_,{});case"region":return(0,a.jsx)(v,{name:"region",placeholder:"Регион",required:!0,submitted:n,options:["1"]});case"number":return(0,a.jsx)(b.Z,{type:"number",name:t.name,placeholder:t.placeholder,required:t.required,after:t.after,submitted:n});case"textarea":case"textarea":return(0,a.jsx)(b.Z,{type:"textarea",name:t.name,placeholder:t.placeholder,required:t.required,submitted:n});case"select":return(0,a.jsx)(v,{name:t.name,placeholder:t.placeholder,required:t.required,submitted:n,options:t.options});case"hidden":return(0,a.jsx)(b.Z,{type:"hidden",name:t.name,placeholder:t.placeholder,required:!1,value:t.value});case"checkbox":return(0,a.jsx)(h.Z,{name:t.name,placeholder:t.placeholder,required:t.required,options:t.options||[""],submitted:n});case"radio":return(0,a.jsx)(g,{name:t.name,placeholder:t.placeholder,required:t.required,options:t.options,submitted:n});default:return(0,a.jsx)(b.Z,{type:"text",name:t.name,placeholder:t.placeholder,required:t.required,after:t.after,submitted:n})}};var k=n(993),E=!0,C=function(e){let{data:t}=e,[n,s]=(0,m.useState)(!1),[d,o]=(0,m.useState)(null),[h]=(0,i.Z)("user",null),x=(0,p.useRouter)();(0,m.useEffect)(()=>{(null==h?void 0:h.username)||o({name:"UnauthorizedException",message:"Не сте оторизиран, моля влезте с акаунта си"})},[h]);let f=[{name:"title",placeholder:"Заглавие",type:"text",required:!0},{name:"description",placeholder:"Описание",type:(null==t?void 0:t.hidedescription)?"hidden":"textarea"},{name:"upload",placeholder:"Картинки",type:"upload"},null==t?void 0:t.fields,{name:"price",placeholder:"Цена",type:(null==t?void 0:t.hideprice)?"hidden":"text",after:"лв.",required:null==t||!t.hideprice||void 0},{name:"phone",placeholder:"Телефон"}].flat().filter(Boolean);return(0,a.jsxs)(l.Z,{children:[d&&(0,a.jsx)(k.Z,{err:d}),(0,a.jsx)("div",{className:"fullgridcontaineritem",children:(0,a.jsx)("h1",{className:"text-5xl leadingtext",children:t.name})}),(0,a.jsxs)("form",{onSubmit:e=>N(e).then(async e=>{console.log(e),s(!0);try{var n,a,i,l;await u((null==h?void 0:h.sub)||"");let d={id:(0,r.ulid)(),sortID:"ads",title:null===(n=e.title)||void 0===n?void 0:n.value,price:e.price.value?Number(e.price.value):0,condition:(null===(a=e.condition)||void 0===a?void 0:a.value)||"USED",data:JSON.stringify(e),images:(null===(i=e.images)||void 0===i?void 0:i.map(e=>e.value))||[],parrent:t.parrent,cat:t.slug,type:t.slug,query:JSON.stringify(e).replace(/[{}\[\]:",]/g," "),description:null===(l=e.description)||void 0===l?void 0:l.value};console.log(d);let p=await c.bl.graphql((0,c.wT)(c.P$.Vl,{input:d}));x.push("/ads/ad/"+p.data.createAd.id)}catch(m){console.log(m),o(m.message?m:m.errors[0])}window.scrollTo({top:0,behavior:"smooth"})}),children:[f.map(e=>(0,a.jsx)("div",{className:"my-6",children:(0,a.jsx)(q,{inputschema:e,submitted:n})},e.name)),(0,a.jsx)("div",{className:"flex justify-end ",children:(0,a.jsx)("button",{type:"submit",className:"btn",disabled:!!d,children:"Добави"})})]})]})}},6601:function(){},9214:function(){}},function(e){e.O(0,[631,662,714,384,856,791,86,614,774,888,179],function(){return e(e.s=5815)}),_N_E=e.O()}]);